title = "Verificar Email"
layout = "default"
url = "/verify-email"

[account]
isDefault = 1
redirect = "dashboard"
==
<?php
function onStart()
{
    // Si el usuario ya verificó su email y está autenticado, redirigir al dashboard
    if (Auth::check() && Auth::getUser()->hasVerifiedEmail()) {
        return Redirect::to('/dashboard');
    }
}
?>
==

<div class="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <div class="text-center">
            <div class="mx-auto w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center mb-6">
                <i class="fas fa-envelope-open-text text-5xl text-primary"></i>
            </div>

            {% if user and user.hasVerifiedEmail() %}
                <!-- Email ya verificado -->
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                    Email Verificado
                </h2>
                <p class="text-gray-600 dark:text-gray-400 mb-8">
                    Tu dirección de correo electrónico ya está verificada.
                </p>
                <a href="/dashboard" class="btn btn-primary">
                    Ir al Dashboard
                </a>

            {% elseif user %}
                <!-- Usuario autenticado pero no verificado -->
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                    Verifica tu Email
                </h2>
                <p class="text-gray-600 dark:text-gray-400 mb-8">
                    Hemos enviado un enlace de verificación a <strong>{{ user.email }}</strong>.
                    Por favor revisa tu bandeja de entrada y haz clic en el enlace para verificar tu cuenta.
                </p>

                <!-- Botón para reenviar email de verificación -->
                <div
                    data-request="{{ account::getAlias() }}::onVerifyEmail"
                    data-request-success="Alpine.store('toast').success('Correo de verificación enviado')"
                    data-request-error="Alpine.store('toast').error('Error al enviar correo')"
                >
                    <button
                        type="button"
                        class="btn btn-primary"
                        data-attach-loading
                    >
                        <i class="fas fa-paper-plane mr-2"></i>
                        Reenviar Email de Verificación
                    </button>
                </div>

                <div class="divider my-6">O</div>

                <a href="/dashboard" class="btn btn-outline btn-sm">
                    Ir al Dashboard
                </a>

            {% else %}
                <!-- Usuario no autenticado -->
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                    Verificación de Email
                </h2>
                <p class="text-gray-600 dark:text-gray-400 mb-8">
                    Por favor inicia sesión para verificar tu dirección de correo electrónico.
                </p>
                <a href="/login" class="btn btn-primary">
                    Iniciar Sesión
                </a>
            {% endif %}
        </div>
    </div>
</div>
