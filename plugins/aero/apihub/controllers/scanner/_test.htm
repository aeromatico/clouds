<div class="callout callout-info">
    <div class="header">
        <h3>üß™ Sistema de Prueba - Diagn√≥stico AJAX</h3>
    </div>
    <div class="content">
        <p>Vamos a probar si AJAX funciona correctamente.</p>

        <button
            type="button"
            id="testBtn"
            class="btn btn-primary"
            data-request="onTestAjax"
            data-request-update="'test': '#testResult'">
            <i class="icon-play"></i> PRUEBA CLICK AQU√ç
        </button>

        <div id="testResult" style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 5px;">
            <p>Esperando click...</p>
        </div>

        <hr>

        <h4>Logs de Diagn√≥stico:</h4>
        <div id="logs" style="background: #000; color: #0f0; padding: 10px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
            <div>Sistema iniciado...</div>
        </div>
    </div>
</div>

<script>
(function() {
    const log = function(msg) {
        const logsDiv = document.getElementById('logs');
        const time = new Date().toLocaleTimeString();
        logsDiv.innerHTML += '<div>[' + time + '] ' + msg + '</div>';
        logsDiv.scrollTop = logsDiv.scrollHeight;
        console.log('[Test]', msg);
    };

    document.addEventListener('DOMContentLoaded', function() {
        log('DOM cargado');

        if (typeof $ === 'undefined') {
            log('‚ùå ERROR: jQuery NO est√° cargado!');
        } else {
            log('‚úì jQuery versi√≥n: ' + $.fn.jquery);
        }

        if (typeof $.request === 'undefined') {
            log('‚ùå ERROR: October AJAX framework NO est√° cargado!');
        } else {
            log('‚úì October AJAX framework est√° cargado');
        }

        const testBtn = document.getElementById('testBtn');
        if (testBtn) {
            log('‚úì Bot√≥n de prueba encontrado');

            // Listener nativo
            testBtn.addEventListener('click', function() {
                log('Click detectado (listener nativo)');
            });

            // Listener jQuery
            $('#testBtn').on('click', function() {
                log('Click detectado (listener jQuery)');
            });

            // Listener AJAX
            $(document).on('ajaxSetup', '[data-request="onTestAjax"]', function(event, context) {
                log('AJAX Setup iniciado');
            });

            $(document).on('ajaxPromise', '[data-request="onTestAjax"]', function(event, context) {
                log('AJAX Promise creado');
            });

            $(document).on('ajaxFail', '[data-request="onTestAjax"]', function(event, context, textStatus, jqXHR) {
                log('‚ùå AJAX FAILED: ' + textStatus);
                log('Response: ' + jqXHR.responseText);
            });

            $(document).on('ajaxError', '[data-request="onTestAjax"]', function(event, context, textStatus, jqXHR) {
                log('‚ùå AJAX ERROR: ' + textStatus);
            });

            $(document).on('ajaxSuccess', '[data-request="onTestAjax"]', function(event, context, data, textStatus, jqXHR) {
                log('‚úÖ AJAX SUCCESS!');
                log('Data recibida: ' + JSON.stringify(data));
            });

            $(document).on('ajaxComplete', '[data-request="onTestAjax"]', function(event, context, textStatus, jqXHR) {
                log('AJAX Completado (status: ' + textStatus + ')');
            });
        } else {
            log('‚ùå ERROR: Bot√≥n de prueba NO encontrado!');
        }

        log('Sistema de diagn√≥stico listo');
    });
})();
</script>
