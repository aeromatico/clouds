{% for itemKey, item in cartItems %}
    <div class="card bg-base-200 border border-base-300">
        <div class="card-body p-4">
            <div class="flex flex-col md:flex-row md:items-center gap-4">
                <!-- Product Info -->
                <div class="flex-1">
                    <h3 class="font-semibold text-lg text-gray-900 dark:text-white">
                        {{ item.plan_name }}
                    </h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                        {{ item.service_name }}
                    </p>
                    <div class="badge badge-outline badge-sm mt-2">
                        {{ component.getBillingCycleLabel(item.billing_cycle) }}
                    </div>
                </div>

                <!-- Quantity Controls -->
                <div class="flex items-center gap-3">
                    <label class="text-sm font-medium">Cantidad:</label>
                    <div class="join">
                        <button
                            class="btn btn-sm join-item"
                            data-request="cart::onUpdateQuantity"
                            data-request-data="{ item_key: '{{ itemKey }}', quantity: {{ item.quantity - 1 }} }"
                            {{ item.quantity <= 1 ? 'disabled' : '' }}>
                            <i class="fas fa-minus"></i>
                        </button>
                        <input
                            type="number"
                            value="{{ item.quantity }}"
                            class="input input-sm input-bordered join-item w-16 text-center"
                            min="1"
                            readonly>
                        <button
                            class="btn btn-sm join-item"
                            data-request="cart::onUpdateQuantity"
                            data-request-data="{ item_key: '{{ itemKey }}', quantity: {{ item.quantity + 1 }} }">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>

                <!-- Price -->
                <div class="text-right">
                    <div class="text-lg font-bold text-primary">
                        ${{ (item.price * item.quantity)|number_format(2) }}
                    </div>
                    <div class="text-xs text-gray-500">
                        ${{ item.price|number_format(2) }} x {{ item.quantity }}
                    </div>
                </div>

                <!-- Remove Button -->
                <button
                    class="btn btn-ghost btn-sm btn-circle"
                    data-request="cart::onRemoveFromCart"
                    data-request-data="{ item_key: '{{ itemKey }}' }"
                    data-request-confirm="Â¿Eliminar este item del carrito?">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Features -->
            {% if item.features %}
                <div class="mt-3 pt-3 border-t border-base-300">
                    <div class="text-xs text-gray-600 dark:text-gray-400">
                        <strong>Incluye:</strong>
                        {{ item.features|join(', ') }}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
{% endfor %}
